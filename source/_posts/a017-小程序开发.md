---
title:  小程序开发
categories:
  - 前端学习
tags:
  - 小程序
  - 云开发
date: 2022-09-09 15:57:01
index_img: https://img0.baidu.com/it/u=3039994811,3905706414&fm=253&fmt=auto&app=138&f=JPEG?w=600&h=338
---

### 不同形式的移动客户端
1. H5

2. 原生App

3. 基于App的二级生态
    >   公众号
    >   小程序


### 各部分组成
1. App
    >   是一个全局对象，代表整个小程序，有且只有一个
    >
    >   app.js    监听app的生命周期，存储全局数据                                             是否必须(否)
    >
    >   app.wxss  全局样式配置                                                                是否必须(否)
    >
    >   app.json  pages注册，必须注册pages，至少一个；window窗口；导航栏；tabbar选项卡等         是否必须(是)

2. Page
    >   用户所看到的一整个页面
    >
    >   page.js   监听page的生命周期，页面数据，页面逻辑                                      是否必须(是)
    >
    >   page.wxml 页面结构，数据渲染，事件绑定                                                是否必须(是)
    >
    >   page.wxss 页面样式                                                                    是否必须(否)
    >
    >   page.json component注册，导航栏，上下拉刷新等                                            是否必须(否)

3. Component
    >   组成页面的一小部分
    >
    >   component.js      组件数据，组件逻辑                                                  是否必须(是)
    >
    >   component.wxml    数据渲染，事件绑定                                                  是否必须(是)
    >
    >   component.wxss    组件样式                                                             是否必须(否)
    >
    >   component.json    组件设置"component": true；组件注册                                   是否必须(否)


### 配置
小程序开发不需要依赖其他的库或自己写功能，好多功能都有自带的配置

1. 项目开发配置
    >   project.config.json
    >
    >   也可以通过可视化界面设置：开发工具右上角 => 详情 => 本地设置

2. 小程序收录配置
    >   [sitemap.json](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/sitemap.html)
    >
    >   微信小程序在20190329推出了sitemap功能
    >
    >   将会默认收录所有小程序的页面内容，用于微信搜索场景。类似于网站的SEO
    >
    >   这意味着开发者的小程序曝光率的增加

3. 全局配置
    >   [app.json](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html)
    >
    >   对小程序进行全局配置
    >   
    >   决定页面路径；窗口表现；设置网络超时时间等。重点掌握window|pages|tabBar

4. 页面配置
    >   [page.json](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html)
    >
    >   对小程序单个页面生效


### WXML
1. [数据绑定](https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/data.html)
    >   数据绑定使用 Mustache 语法（双大括号）将变量包起来
    >
    >   `{{}}`中只能写表达式，不能写代码。同vue和react

2. [条件渲染](https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/conditional.html)
    >   `<block/>` 并不是一个组件，它仅仅是一个包装元素，不会在页面中做任何渲染，只接受控制属性。
    >
    >   hidden  组件始终会被渲染，只是简单的控制显示与隐藏。
    >
    >   wx:if 有更高的切换消耗而 hidden 有更高的初始渲染消耗

3. [列表渲染](https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/list.html)
    >   wx:key 默认为index
    >
    >   wx:key 的值以两种形式提供
    >   字符串，代表在 for 循环的 array 中 item 的某个 property，该 property 的值需要是列表中唯一的字符串或数字，且不能动态改变。
    >   保留关键字 *this 代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个唯一的字符串或者数字。
    >
    >   setData 数据更新并触发视图更新，增量式更新。同react

4. [事件绑定](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html)
    >   事件是视图层到逻辑层的通讯方式
    >
    >   事件对象可以携带额外的参数，如id、dataset、touches。
    >
    >   target，触发事件的源组件。
    >   currentTarget，事件绑定的当前组件。
    >
    >   从外到内传递(找到目标元素)的过程称为捕获，从内到外处理(事件处理)的过程称为冒泡。
    >
    >   touches，表示当前停留在屏幕上的触摸点。
    >   changedTouches， 表示有变化的触摸点。
    >
    >   除 bind 外，也可以用 catch 来绑定事件。与 bind 不同， catch 会阻止事件向上冒泡。
    >
    >   需要在捕获阶段监听事件时，可以采用capture-bind。capture-catch关键字，将中断捕获阶段和取消冒泡阶段。
    >
    >   互斥事件绑定，mut-bind

5. [模板](https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/template.html)
    >   WXML提供模板（template），可以在模板中定义代码片段，然后在不同的地方调用。
    >
    >   可以理解为只能渲染的组件，没有自己的对应js和css文件。使用场景不多

6. [引用](https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/import.html)
    >   import可以在该文件中使用目标文件定义的template
    >
    >   include 可以将目标文件除了 `<template/>` `<wxs/>` 外的整个代码引入，相当于是拷贝到 include 位置


### WXS
1.  [文档](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxs/)
2.  写一些函数，辅助做一些渲染层的数据处理 
3.  可以在渲染层主动调用方法，例如格式化日期、截取字符串


### WXSS
1. [文档](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html)
    >   全局样式app.wxss，可以作用于页面，但不能作用于组件

2. 尺寸单位rpx
    >   所有设备类型的宽度都为750rpx
    >
    >    以iPhone6 作为视觉稿的标准，1px = 2rpx

3. [weUI](https://developers.weixin.qq.com/miniprogram/dev/platform-capabilities/extended/weui/)
    ```
        npm init -y
        npm i weui-miniprogram
        左上角工具 => 构建npm
        app.wxss 里面引入 weui.wxss
        page.json 中引入组件 => 页面中使用组件
    ```


### 组件
1.  text组件，用于展示文本，内部只能嵌套text组件

2.  背景图使用FeHelper将图片转换成base64编码格式

3. [swiper](https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html)

4. [movable-area](https://developers.weixin.qq.com/miniprogram/dev/component/movable-area.html)

5. [scroll-view](https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html)

6. [自定义组件](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/)


### 生命周期、路由、API
1. [App生命周期](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html)

2. [Page生命周期](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html)

3. [Component生命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html)

4. [页面路由](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html)

5. [API](https://developers.weixin.qq.com/miniprogram/dev/api/)
    > wx.request 接口请求
    >   +  生产环境：微信公众平台    =>  开发管理    =>  开发设置    =>  服务器域名中配置(需要支持https)
    >   +  开发环境：右上角详情   =>  本地设置    =>  不校验合法域名


### 云开发
1. 不使用云开发
一门后端语言 + 购买服务器(只有ip) + 购买域名 + 购买证书(支持https)

2. 使用云开发
    >   在一个全部都已经部署好的环境中(云环境),直接以函数的形式使用各种服务(文件存储、数据库存储、计算处理、三方服务等)，完成各种操作。可以理解为前后端代码放在一块，可以直接调用
    >
    >   [云开发能力](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/capabilities.html)
    >
    >   云函数内部可以操作云存储、云数据库、云调用；HTTP API可以操作云存储、云数据库、云函数。    

3. [云开发介绍](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/quickstart.html)
    >   云环境和AppID是绑定的，会自动识别项目的AppID
    >
    >   云环境创建后名称不能修改
    >
    >   云环境最多创建两个(开发、发布)

4. [云数据库](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/database/init.html)

5. [云函数](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/getting-started.html)
+   云函数需要手动创建
+   已有项目中添加云函数功能
    >   项目中用两个文件夹区分 项目文件(除projec.config.json) 云函数
    >
    >   并在projec.config.json中添加，`"miniprogramRoot": "app/"`，`"cloudfunctionRoot": "appFunc/"`

+   新建项目中添加云函数功能
    >   创建项目时勾选使用云开发，即可自动创建相应目录，并包含相关测试云函数

+   API分类
    >   小程序端调用、服务端调用(云函数中调用)

+   使用
    >   axios使用会报错，建议使用request-promise
    >
    >   每次修改函数内容，都需要重新上传和部署；或者右键点击函数的index.js，选择增量式更新

---
参考文档:
*   [微信官方文档](https://developers.weixin.qq.com/miniprogram/dev/framework/structure.html)
*   [微信公众平台](https://mp.weixin.qq.com/)

参考视频:
*   [BV1YJ411W7YA](https://www.bilibili.com/video/BV1YJ411W7YA)