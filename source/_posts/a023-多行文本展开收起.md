---
title: 多行文本展开收起
categories:
  - 前端学习
tags:
  - 文本折叠
date: 2023-03-25 16:35:57
index_img: https://img0.baidu.com/it/u=3492806111,569680476&fm=253&fmt=auto&app=138&f=JPEG?w=1000&h=500
---

### 效果

<img src="/img/sample/a023/a023.gif" alt="">

### 描述

文字区域超过4行只显示4行，且显示展开按钮，点击展示剩余文字
文字全部展开后，显示收起按钮，点击还原为之前的状态

### 代码部分

App.jsx

```javascript
import { useState, useRef, useEffect } from 'react'
import './App.less'

function App() {
  const [fold, setFold] = useState(true)
  const [isMoreThan4Line, setisMoreThan4Line] = useState(false);
  const descBox = useRef(null)
  const renderRef = useRef(true)

  useEffect(() => {
    if (renderRef.current) {
      renderRef.current = false
      return
    }
    computedLine()
  }, []);

  const computedLine = () => {
    const height = descBox.current.scrollHeight;

    const lineHeight = window
      .getComputedStyle(descBox.current)
      .lineHeight.match(/\d+\.*\d+/g)[0];

    setisMoreThan4Line(height / lineHeight > 4)
  }

  return (
    <div className="App">
      <div className="acco-b" >
        <input type="checkbox" className="toggleInput" id="toggleInput" checked={fold} onChange={(evt) => setFold(evt.target.checked)} />

        <div className="activity-desc" ref={descBox}>
          小王子看到一座盛开的玫瑰园时，他非常伤心。因为他的玫瑰对他说谎说她是宇宙中一朵独一无二的花。不过，在狐狸的引导下，小王子认识她们和他的玫瑰虽然类似，但因为他给他的玫瑰盖过罩子，因为他给她竖过屏风，因为他给她除过毛虫，因为他听过她的埋怨、吹嘘，甚至她的沉默，所以他的那朵玫瑰在世上是唯一的。

          {fold && isMoreThan4Line && (
            <label className="btn" htmlFor="toggleInput">展开</label>
          )}
          {!fold && isMoreThan4Line && (
            <label className="btn-no-absolute" htmlFor="toggleInput" >收起</label>
          )}
        </div>
      </div>
    </div>
  )
}

export default App
```

App.less

```less
.acco-b {
    display: flex;
    margin-top: 20px;

    .toggleInput {
        display: none;
    }

    .toggleInput:checked+.activity-desc {
        display: -webkit-box;
        overflow: hidden;
        -webkit-line-clamp: 4;
        -webkit-box-orient: vertical;
    }

    .activity-desc {
        word-break: break-all;
        -webkit-line-clamp: 100;
        // -webkit-line-clamp: none;
        padding: 0;
        position: relative;
        line-height: 18px;
        font-size: 15px;
        font-weight: 400;
        color: #666666;

        .btn {
            position: absolute;
            bottom: 0px;
            right: 0;
            line-height: 18px;
            font-size: 15px;
            color: #0FD243;
            background: #fff;

            &::before {
                content: '...';
                color: #8a8f99;
                transform: translateX(-100%);
            }
        }

        .btn-no-absolute {
            float: none;
            font-size: 15px;
            font-weight: 400;
            color: #0FD243;
        }
    }
}
```